<!DOCTYPE html>
<html lang="en">

<head>
    <!--
            Brendan Ly
            October 19, 2022
        -->
    <meta charset='utf-8' />
    <meta name="viewport" content="width=device-width" />
    <title>Seven Segment Clock</title>
    <style>
        @import "portfolio.css";
        body {
            text-align: center;
            font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
            background-color: black;
            color: white;
        }

        button {
            height: 48px;
            width: 48px;
            border: 2px solid white;
            background-color: yellow;
            border-radius: 5px;
            margin: 5px;
        }
    </style>
<script src='navigation.js'>
    
</script>
</head>

<body>
    <h1>Seven Segment Clock</h1>
    <svg width='800' height='200' viewBox='0 0 800 200' xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink">

        <defs>
            <polygon points='12 0
                        24 12 
                        24 60
                        12 72
                        0 60
                        0 12' id='segment' />
        </defs>

        <rect x='0' y='0' width='800' height='200' fill='black' />
        <!--  72px wide, 12 px top margin -->
        <g id='hour1' transform='translate(0 0)'>
            <use xlink:href="#segment" transform='translate(64 -12) rotate(90 12 36)' class='a' />
            <use xlink:href="#segment" transform='translate(102 26)' class='b' />
            <use xlink:href="#segment" transform='translate(102 100)' class='c' />
            <use xlink:href="#segment" transform='translate(64 138) rotate(90 12 36)' class='d' />
            <use xlink:href="#segment" transform='translate(26 100)' class='e' />
            <use xlink:href="#segment" transform='translate(26 26)' class='f' />
            <use xlink:href="#segment" transform='translate(64 63) rotate(90 12 36)' class='g' />
        </g>
        <g id='hour2' transform='translate(120 0)'>
            <use xlink:href="#segment" transform='translate(64 -12) rotate(90 12 36)' class='a' />
            <use xlink:href="#segment" transform='translate(102 26)' class='b' />
            <use xlink:href="#segment" transform='translate(102 100)' class='c' />
            <use xlink:href="#segment" transform='translate(64 138) rotate(90 12 36)' class='d' />
            <use xlink:href="#segment" transform='translate(26 100)' class='e' />
            <use xlink:href="#segment" transform='translate(26 26)' class='f' />
            <use xlink:href="#segment" transform='translate(64 63) rotate(90 12 36)' class='g' />
        </g>

        <circle cx='271' cy='80' r='10' fill='red' />
        <circle cx='271' cy='120' r='10' fill='red' />

        <g id='minute1' transform='translate(270 0)'>
            <use xlink:href="#segment" transform='translate(64 -12) rotate(90 12 36)' class='a' />
            <use xlink:href="#segment" transform='translate(102 26)' class='b' />
            <use xlink:href="#segment" transform='translate(102 100)' class='c' />
            <use xlink:href="#segment" transform='translate(64 138) rotate(90 12 36)' class='d' />
            <use xlink:href="#segment" transform='translate(26 100)' class='e' />
            <use xlink:href="#segment" transform='translate(26 26)' class='f' />
            <use xlink:href="#segment" transform='translate(64 63) rotate(90 12 36)' class='g' />
        </g>
        <g id='minute2' transform='translate(390 0)'>
            <use xlink:href="#segment" transform='translate(64 -12) rotate(90 12 36)' class='a' />
            <use xlink:href="#segment" transform='translate(102 26)' class='b' />
            <use xlink:href="#segment" transform='translate(102 100)' class='c' />
            <use xlink:href="#segment" transform='translate(64 138) rotate(90 12 36)' class='d' />
            <use xlink:href="#segment" transform='translate(26 100)' class='e' />
            <use xlink:href="#segment" transform='translate(26 26)' class='f' />
            <use xlink:href="#segment" transform='translate(64 63) rotate(90 12 36)' class='g' />
        </g>
        <circle cx='541' cy='80' r='10' fill='red' />
        <circle cx='541' cy='120' r='10' fill='red' />
        <g id='second1' transform='translate(540 0)'>
            <use xlink:href="#segment" transform='translate(64 -12) rotate(90 12 36)' class='a' />
            <use xlink:href="#segment" transform='translate(102 26)' class='b' />
            <use xlink:href="#segment" transform='translate(102 100)' class='c' />
            <use xlink:href="#segment" transform='translate(64 138) rotate(90 12 36)' class='d' />
            <use xlink:href="#segment" transform='translate(26 100)' class='e' />
            <use xlink:href="#segment" transform='translate(26 26)' class='f' />
            <use xlink:href="#segment" transform='translate(64 63) rotate(90 12 36)' class='g' />
        </g>
        <g id='second2' transform='translate(660 0)'>
            <use xlink:href="#segment" transform='translate(64 -12) rotate(90 12 36)' class='a' />
            <use xlink:href="#segment" transform='translate(102 26)' class='b' />
            <use xlink:href="#segment" transform='translate(102 100)' class='c' />
            <use xlink:href="#segment" transform='translate(64 138) rotate(90 12 36)' class='d' />
            <use xlink:href="#segment" transform='translate(26 100)' class='e' />
            <use xlink:href="#segment" transform='translate(26 26)' class='f' />
            <use xlink:href="#segment" transform='translate(64 63) rotate(90 12 36)' class='g' />
        </g>
    </svg>

    <div id='controls'>
        <button>&nbsp;</button>
        <button>&nbsp;</button>
        <button>&nbsp;</button>
        <button>&nbsp;</button>
        <button>&nbsp;</button>
        <button>&nbsp;</button>
    </div>


    <script>
        function get(id) {
            return document.getElementById(id);
        }

        var onColor = 'red';
        var offColor = '#121212';

        var segmentsTable = [
            "abcdef", // 0
            "bc", // 1
            "abged", // 2
            "abgcd", // 3
            "fbgc", // 4
            "afgcd", // 5
            "afgedc", // 6
            "abc", // 7
            "abcdefg", // 8
            "abgfcd", // 9
        ];
        var timer = setInterval(showTime, 500);
        setupButtons();
        showTime();

        function setupButtons() {
            var colors = [
                "red",
                "orange",
                "yellow",
                "green",
                "dodgerblue",
                "violet",
            ];
            var buttons = get('controls').getElementsByTagName('button');

            for (var i = 0; i < buttons.length; i++) {
                buttons[i].style.backgroundColor = colors[i];
                buttons[i].onclick = changeOnColor;
            }
        }

        function changeOnColor(e) {
            onColor = e.currentTarget.style.backgroundColor;
            var circles = document.getElementsByTagName('circle');
            for (var i = 0; i < circles.length; i++) {
                circles[i].setAttribute('fill', onColor);
            }
            showTime();
        }

        function showTime() {
            var time = new Date();
            var hours = time.getHours();
            
            // convert 24-hour clock to 12-hour clock
            hours = ((hours + 11) % 12 + 1);

            var minutes = time.getMinutes();
            var seconds = time.getSeconds();
            showDigit('hour1', Math.floor(hours / 10));
            showDigit('hour2', hours % 10);
            showDigit('minute1', Math.floor(minutes / 10));
            showDigit('minute2', minutes % 10);
            showDigit('second1', Math.floor(seconds / 10));
            showDigit('second2', seconds % 10);
        }

        function showDigit(id, n) {
            turnSegmentOff(id);
            var segments = segmentsTable[n];
            for (var i = 0; i < segments.length; i++) {
                turnSegmentOn(id, segments[i]);
            }
        }

        function turnSegmentOff(id) {
            var use = get(id).getElementsByTagName('use');
            for (var i = 0; i < use.length; i++) {
                use[i].setAttribute('fill', offColor)
            }
        }

        function turnSegmentOn(id, segmentID) {
            var g = get(id);
            console.log(id, segmentID);
            var segment = g.getElementsByClassName(segmentID)[0];
            segment.setAttribute('fill', onColor);
        }

        // showDigit('hour1', 1);
        // showDigit('hour2', 2);
        // showDigit('minute1', 3);
        // showDigit('minute2', 4);
        // showDigit('second1', 5);
        // showDigit('second2', 6);

    </script>
        <div id='case'>
            <p>
                <b>Objective:</b> Develop an app that tells the time in a seven segment display. 

            </p>
            <p>
                <b>Problem:</b> There are too many segments in the seven segment display to change at a time.
            </p>
            <p>
                <b>Solution:</b> Use a translation table to limit the number of segments turning on and off to eight. 

            </p>
        </div>
            <nav>
                <a href='index.html'>
                    <img src='nav/darkblue-arrow-left.png' alt='previous' />
                </a>
                <a href='index.html'>
                    <img src='nav/darkblue-grid.png' alt='home' />
                </a>
                <a href='index.html'>
                    <img src='nav/darkblue-arrow-right.png' alt='next' />
                </a>
            </nav>
</body>

</html>